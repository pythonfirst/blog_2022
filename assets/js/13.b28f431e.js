(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{593:function(t,s,n){"use strict";n.r(s);var a=n(17),e=Object(a.a)({},(function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h2",{attrs:{id:"源起"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#源起"}},[t._v("#")]),t._v(" 源起")]),t._v(" "),n("p",[t._v("最近心血来潮，折腾一个 vuepress 博客部署到腾讯云上。因为之前折腾过一次 hexo 的博客，以为这次肯定很轻松就能搞定。结果在 nginx 配置上还是遇到一个小小的坑，这篇文章用来记录一下。")]),t._v(" "),n("p",[t._v("云服务器的登录配置这里不再赘述，网上有很多文章讲，直接从 nginx 配置开始。")]),t._v(" "),n("h2",{attrs:{id:"安装-nginx"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#安装-nginx"}},[t._v("#")]),t._v(" 安装 nginx")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt")]),t._v(" update\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt")]),t._v(" nginx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("h2",{attrs:{id:"启动-nginx"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#启动-nginx"}},[t._v("#")]),t._v(" 启动 nginx")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 启用 Nginx")]),t._v("\nsystemctl start nginx\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 设置为在系统启动时自动启动")]),t._v("\nsystemctl "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("enable")]),t._v(" nginx\n")])])]),n("h2",{attrs:{id:"修改配置文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#修改配置文件"}},[t._v("#")]),t._v(" 修改配置文件")]),t._v(" "),n("h3",{attrs:{id:"含有-sites-enable-default-默认文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#含有-sites-enable-default-默认文件"}},[t._v("#")]),t._v(" 含有 sites-enable/default 默认文件")]),t._v(" "),n("p",[t._v("不同版本的 nginx 这里会有差别，主要体现在 nginx 配置文件上。我安装的版本配置文件存在两个分别为 "),n("code",[t._v("etc/nginx/nginx.conf")]),t._v(" 和 "),n("code",[t._v("etc/nginx/sites-enabled/default")]),t._v("。相当于 nginx 会将两个文件组合在一起。此时起一个最简单的静态文件服务器，需要修改 default 文件。")]),t._v(" "),n("p",[t._v("default 文件已经配置了默认监听端口 80, 因为只是测试静态服务，我们只改一下 root 指令配置即可: "),n("code",[t._v("root /home/www/html;")])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[t._v("server "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        listen "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v(" default_server"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        listen "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("::"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(":80 default_server"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("å\n\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 主要配置80端口监听的根目录")]),t._v("\n        root /home/www/html"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Add index.php to the list if you are using PHP")]),t._v("\n        index index.html index.htm index.nginx-debian.html"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        server_name _"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        location / "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# First attempt to serve request as file, then")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# as directory, then fall back to displaying a 404.")]),t._v("\n                try_files "),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$uri")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$uri")]),t._v("/ "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("404")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("h3",{attrs:{id:"普通的-nginx-conf-配置文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#普通的-nginx-conf-配置文件"}},[t._v("#")]),t._v(" 普通的 nginx.conf 配置文件")]),t._v(" "),n("p",[t._v("配置的 root 同上，只不过因为不需要合并 default，需要在 etc/nginx/nginx.conf 文件中的 http 块添加 server 块。")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[t._v("http "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n server "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        listen "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v(" default_server"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        listen "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("::"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(":80 default_server"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("å\n\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 主要配置80端口监听的根目录")]),t._v("\n        root /home/www/html"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Add index.php to the list if you are using PHP")]),t._v("\n        index index.html index.htm index.nginx-debian.html"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        server_name _"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        location / "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# First attempt to serve request as file, then")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# as directory, then fall back to displaying a 404.")]),t._v("\n                try_files "),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$uri")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$uri")]),t._v("/ "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("404")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("h2",{attrs:{id:"创建测试文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#创建测试文件"}},[t._v("#")]),t._v(" 创建测试文件")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 创建静态文件目录")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("mkdir")]),t._v(" -p home/www/html"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" home/www/html\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 创建index.html")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("touch")]),t._v(" index.html"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("vim")]),t._v(" index.html  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 随便写一些内容即可。")]),t._v("\n")])])]),n("h2",{attrs:{id:"重启-nginx"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#重启-nginx"}},[t._v("#")]),t._v(" 重启 nginx")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 重新启动 nginx，以使更改的配置生效。")]),t._v("\nnginx -s reload\n\n")])])]),n("h2",{attrs:{id:"访问公网地址验证"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#访问公网地址验证"}},[t._v("#")]),t._v(" 访问公网地址验证")])])}),[],!1,null,null,null);s.default=e.exports}}]);